{% extends 'base.html.twig' %}

{% block title %}{{ 'cart.title'|trans }}{% endblock %}

{% block body %}
<div class="container mt-5 text-light">
    <div class="hero-cart mb-4 p-4 p-lg-5 rounded">
        <p class="badge bg-info text-dark mb-2">{{ 'cart.badge'|trans }}</p>
        <h1 class="fw-bold mb-2">üß∫ {{ 'cart.title'|trans }}</h1>
        <p class="text-muted mb-0">{{ 'cart.subtitle'|trans }}</p>
    </div>

    {% if items is empty %}
        <p class="text-center text-muted">{{ 'cart.empty'|trans }}</p>
        <div class="text-center mt-3">
            <a href="{{ path('app_shop_index') }}" class="btn btn-outline-info">‚¨Ö {{ 'cart.back_shop'|trans }}</a>
        </div>
    {% else %}
        <div class="card bg-dark border-info shadow-lg p-4">
            <table class="table table-dark table-hover align-middle text-center border border-info mb-0">
                <thead class="table-info text-dark">
                    <tr>
                        <th>{{ 'cart.table_product'|trans }}</th>
                        <th>{{ 'cart.table_quantity'|trans }}</th>
                        <th>{{ 'cart.table_unit_price'|trans }}</th>
                        <th>{{ 'cart.table_subtotal'|trans }}</th>
                        <th>{{ 'cart.table_action'|trans }}</th>
                    </tr>
                </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td class="text-start">
                        <div class="fw-bold">{{ item.product.name }}</div>
                        <small class="text-muted">{{ item.product.category ? item.product.category.name : '‚Äî' }}</small>
                    </td>
                    <td>
                        <form method="post"
                              action="{{ path('app_shop_update_quantity', { id: item.product.id }) }}"
                              class="d-flex align-items-center gap-2 justify-content-center"
                              data-product-id="{{ item.product.id }}">
                            <input type="number"
                                   name="quantity"
                                   value="{{ item.quantity }}"
                                   min="1"
                                   max="{{ item.product.stock }}"
                                   class="form-control form-control-sm bg-dark text-light border-info"
                                   style="width: 90px;"
                                   data-product-id="{{ item.product.id }}"
                                   data-action="change->cart#updateQuantity input->cart#updateQuantity">
                        </form>
                    </td>
                        <td>{{ item.product.price }} ‚Ç¨</td>
                        <td data-cart-line-subtotal="{{ item.product.id }}"
                            data-cart-target="lineSubtotal"
                            data-product-id="{{ item.product.id }}">
                            {{ item.subtotal }} ‚Ç¨
                        </td>
                        <td>
                            <a href="{{ path('app_shop_remove', { id: item.product.id }) }}"
                               class="btn btn-sm btn-outline-danger"
                               data-action="click->cart#remove">‚ùå {{ 'cart.remove'|trans }}</a>
                        </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="d-flex justify-content-between align-items-center mt-4">
                <h4>{{ 'cart.total_label'|trans }} <span class="text-info" data-cart-target="pageTotal" id="cart-page-total">{{ total }} ‚Ç¨</span></h4>
                <div>
                    <a href="{{ path('app_shop_clear') }}" class="btn btn-outline-warning me-2">üßπ {{ 'cart.clear'|trans }}</a>
                    <a href="{{ path('app_shop_checkout') }}" class="btn btn-success">üí≥ {{ 'cart.checkout'|trans }}</a>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<style>
    table th, table td {
        vertical-align: middle;
    }
    .btn-success {
        background-color: #198754 !important;
        border: none;
    }
    .btn-success:hover {
        background-color: #157347 !important;
    }
    .hero-cart {
        background: radial-gradient(circle at 20% 20%, rgba(13,202,240,0.12), transparent 30%),
                    #0f131a;
        border: 1px solid rgba(13,202,240,0.15);
        box-shadow: 0 12px 30px rgba(0,0,0,0.35);
    }
</style>

{% endblock %}
